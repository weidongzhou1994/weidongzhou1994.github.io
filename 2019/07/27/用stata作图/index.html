<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/vendors/pace/pace.min.js?v=1.0.2"></script>
  <link href="/vendors/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="基础,Stata,图形,">





  <link rel="alternate" href="/atom.xml" title="周卫东的博客" type="application/atom+xml">






<meta name="description" content="1. stata 作图简介">
<meta name="keywords" content="基础,Stata,图形">
<meta property="og:type" content="article">
<meta property="og:title" content="用 stata 作图">
<meta property="og:url" content="http://zhouweidong.ml/2019/07/27/用stata作图/index.html">
<meta property="og:site_name" content="周卫东的博客">
<meta property="og:description" content="1. stata 作图简介">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-09-03T13:34:23.289Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用 stata 作图">
<meta name="twitter:description" content="1. stata 作图简介">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zhouweidong.ml/2019/07/27/用stata作图/">






  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "2981e3b3"
    });
  daovoice('update');
  </script>

  <title>用 stata 作图 | 周卫东的博客</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">周卫东的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhouweidong.ml/2019/07/27/用stata作图/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="周卫东">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://blog-1258437747.cos.ap-chengdu.myqcloud.com/IMG_9432===_美艺达证件照.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="周卫东的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">用 stata 作图</h1>
        

        <div class="post-meta">
        
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-27T21:34:41+08:00">
                2019-07-27
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-09-03T21:34:23+08:00">
                2020-09-03
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/stata/" itemprop="url" rel="index">
                    <span itemprop="name">stata</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/07/27/用stata作图/" class="leancloud_visitors" data-flag-title="用 stata 作图">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,948
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  19
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="1-stata-zuo-tu-jian-jie">1. stata 作图简介</h1>
<a id="more"></a>
<h2 id="1-1-stata-neng-zuo-shi-yao-tu">1.1 stata 能做什么图</h2>
<pre><code>graph twoway   二维图
      scatter   散点图
      line      折线图
      area      区域图
      lfit      线性拟合图
      qfit      非线性拟合图
      histogram 直方图
      kdensity  密度函数图
      function  函数图     
      matrix   矩阵图
      bar      条形图
      dot      点图
      box      箱形图
      pie      饼图
      ac       相关系数图
      pac      偏相关系数图
      irf      脉冲相应函数图
</code></pre>
<p>  help graph 查看更多 stata 能做的图。</p>
<h2 id="1-2-bao-cun-tu">1.2 保存图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 第一种方式 </span></span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">save</span> [graphname] filename [, asis <span class="keyword">replace</span>]  </span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">use</span> filename [, options]     <span class="comment">// 调用刚才保存的图 </span></span><br><span class="line"><span class="comment">* 第二种方式 </span></span><br><span class="line">[<span class="keyword">graph</span>] <span class="keyword">twoway</span> <span class="keyword">plot</span> [<span class="keyword">if</span>] [<span class="keyword">in</span>] , saving (文件名，<span class="keyword">replace</span>)</span><br><span class="line"><span class="comment">* 手动方式：在图形窗口中点击保存 </span></span><br></pre></td></tr></table></figure>
<h2 id="1-3-dao-chu-tu-xing">1.3 导出图形</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">graph</span> export newfilename.suffix [, options]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>后缀 (.suffix)</th>
<th>附加选项</th>
<th>输出格式</th>
</tr>
</thead>
<tbody>
<tr>
<td>.ps</td>
<td>as (ps)</td>
<td>PostScript</td>
</tr>
<tr>
<td>.eps</td>
<td>as (eps)</td>
<td>Encapsulated PostScript</td>
</tr>
<tr>
<td>.wmf</td>
<td>as (wmf)</td>
<td>Windows Metafile</td>
</tr>
<tr>
<td>.emf</td>
<td>as (emf)</td>
<td>Windows Enhanced Metafile</td>
</tr>
<tr>
<td>.pict</td>
<td>as (pict)</td>
<td>Macintosh PICT format</td>
</tr>
<tr>
<td>.png</td>
<td>as (png)</td>
<td>PNG (Portable Network Graphics)</td>
</tr>
<tr>
<td>.tif</td>
<td>as (tif)</td>
<td>TIFF</td>
</tr>
<tr>
<td>other</td>
<td></td>
<td>must specify as ()</td>
</tr>
</tbody>
</table>
<p>   选项 widtn () 和 height () 可以用于调整图片的分辨率，但仅适用于 .png 和 .tif 格式的图片。</p>
<h2 id="1-4-liu-lan-nei-cun-zhong-de-tu-pian">1.4 浏览内存中的图片</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">graph</span> <span class="keyword">dir</span> [pattern] [, options]</span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">display</span> [name] [, options]   <span class="comment">// 重现内存中的图片 </span></span><br><span class="line"><span class="keyword">graph</span> combine name [name ...] [, options] <span class="comment">// 合并图形 </span></span><br><span class="line">&#123;<span class="keyword">erase</span>|<span class="keyword">rm</span>&#125; [<span class="string">"] filename ["</span>]   <span class="comment">// 删除图形 </span></span><br></pre></td></tr></table></figure>
<h2 id="1-5-shi-yong-hui-tu-mo-ban">1.5 使用绘图模板</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 查看 Stata 内置的模板 </span></span><br><span class="line"><span class="keyword">help</span> schemes</span><br><span class="line"><span class="comment">* 使用绘图模板 </span></span><br><span class="line"><span class="keyword">set</span> scheme schemename [, permanently]       <span class="comment">// 第一种方式 </span></span><br><span class="line"><span class="keyword">graph</span> ...  [, ...  scheme (schemename) ...]  <span class="comment">// 第二种方式 </span></span><br><span class="line"><span class="comment">* 查找更多的绘图模板 </span></span><br><span class="line"><span class="keyword">findit</span> schemes</span><br><span class="line"><span class="comment">* 符合中文期刊风格的纯黑白图形 </span></span><br><span class="line"><span class="comment">* 官方提供： s1mono</span></span><br><span class="line"><span class="comment">* 用户提供： tufte</span></span><br></pre></td></tr></table></figure>
<h1 id="2-er-wei-tu">2. 二维图</h1>
<h2 id="2-1-er-wei-tu-ming-ling-de-ji-ben-jie-gou">2.1 二维图命令的基本结构</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">graph</span>] <span class="keyword">twoway</span> <span class="keyword">plot</span> [<span class="keyword">if</span>] [<span class="keyword">in</span>] [, twoway_options]</span><br><span class="line"><span class="comment">* 多个图 </span></span><br><span class="line"><span class="keyword">twoway</span> (单元图 1) (单元图 2) (...) ，选项 1 选项 2 ...</span><br><span class="line"><span class="keyword">twoway</span>  单元图 1 || 单元图 2 || ... ， 选项 1 选项 2 ...</span><br><span class="line"><span class="comment">* 标准实例 </span></span><br><span class="line"><span class="keyword">sysuse</span> sp500, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> high date) (<span class="keyword">line</span> low date)           <span class="comment">///</span></span><br><span class="line">   ,                                           <span class="comment">///  </span></span><br><span class="line">   title (<span class="string">"图 1：股票最高价与最低价时序图"</span>, box) <span class="comment">///</span></span><br><span class="line">   xtitle (<span class="string">"交易日期"</span>, margin (medsmall))        <span class="comment">///</span></span><br><span class="line">   ytitle (<span class="string">"股票价格"</span>)                          <span class="comment">///</span></span><br><span class="line">   ylabel (900 (200) 1400) ymtick (##5)            <span class="comment">///</span></span><br><span class="line">   legend (<span class="keyword">label</span>(1 <span class="string">"最高价"</span>) <span class="keyword">label</span>(2 <span class="string">"最低价"</span>)) <span class="comment">///</span></span><br><span class="line">   <span class="keyword">note</span>(<span class="string">"资料来源：Stata 公司，SP500.dta"</span>)      <span class="comment">///</span></span><br><span class="line">   caption (<span class="string">"说明：我做的第一幅 Stata 图形！"</span>)    <span class="comment">///</span></span><br><span class="line">   saving (mypig.gph, <span class="keyword">replace</span>)</span><br></pre></td></tr></table></figure>
<h2 id="2-2-er-wei-tu-de-xuan-xiang-jin-yi-bu-diao-zheng-tu-xing">2.2 二维图的选项：进一步调整图形</h2>
<h3 id="2-2-1-zuo-biao-zhou">2.2.1 坐标轴</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 坐标轴标题 </span></span><br><span class="line"><span class="keyword">scatter</span> var_x var_y, ytitle (<span class="string">""</span>, place ()) xtitle () <span class="comment">//place 选项有：top, right 和 left; xtitle (" 第一行 "" 第二行")</span></span><br><span class="line"><span class="comment">* 坐标轴刻度及标签 </span></span><br><span class="line"><span class="comment">* 主刻度及标签：ylabel (), xlabel () // 显示刻度标签时，同时显示刻度 </span></span><br><span class="line"><span class="comment">* 主刻度：      ytick (),  xtick ()  // 按设定显示刻度，仅显示主要刻度的标签 </span></span><br><span class="line"><span class="comment">* 子刻度及标签：ymlabel (),xmlabel ()</span></span><br><span class="line"><span class="comment">* 子刻度：      ymtick (), xmtick ()</span></span><br><span class="line"><span class="comment">* 参数设定规则：</span></span><br><span class="line"><span class="comment">*   rule     example    description</span></span><br><span class="line"><span class="comment">*  --------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   #?       #4         4 个最佳值 </span></span><br><span class="line"><span class="comment">*   ##?      ##10       10-1=9 个子刻度列印于主刻度之间 </span></span><br><span class="line"><span class="comment">*                         仅适用于 mlabel () 和 mtick () 选项 </span></span><br><span class="line"><span class="comment">*   ?(?)?    10 (5) 45    在 10 到 45 范围内，每隔 5 列印一个子刻度 </span></span><br><span class="line"><span class="comment">*   none     none       不显示刻度标签 </span></span><br><span class="line"><span class="comment">*  --------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   注：#? 和 ##? 比较常用 </span></span><br><span class="line"><span class="comment">* 自定义标签: xlable (10 20 30 中位数 40 50) </span></span><br><span class="line"><span class="comment">* 倾斜角度的设置：angle (45)</span></span><br><span class="line"><span class="comment">* 坐标轴结构：yscale () xscale ()</span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, xscale (<span class="keyword">range</span>(0 5000)) xlabel (0 (1000) 5000) <span class="comment">// 表示间隔为 1000</span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight <span class="keyword">if</span> (wei&gt;=3000&amp;wei&lt;=4000)  <span class="comment">// 局部显示需要用 if 语句 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, xscale (titlegap (2))   <span class="comment">// 坐标轴与坐标轴标题间距 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, xscale (titlegap (2) outergap (-2)) <span class="comment">// 坐标轴标题下边距 </span></span><br><span class="line"><span class="comment">* 坐标轴的显示 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, yscale (noline) xscale (noline)  <span class="comment">// 不显示坐标轴 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, yscale (off) xscale (off)        <span class="comment">// 不显示坐标轴和刻度标签 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, yscale (off) xscale (off) plotregion (style (none)) <span class="comment">// 无边距 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, xscale (lcolor (red) lwidth (vthick)) <span class="comment">// 线型的选择：颜色和宽度 </span></span><br><span class="line"><span class="comment">* 双坐标系 (次坐标轴)</span></span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> <span class="keyword">close</span>  date, yaxis (1)) (<span class="keyword">line</span> change date, yaxis (2))</span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> <span class="keyword">close</span>  date, yaxis (1) xaxis (1)) (<span class="keyword">line</span> change date, yaxis (2) xaxis (2))</span><br></pre></td></tr></table></figure>
<h3 id="2-2-2-tu-biao-de-biao-ti">2.2.2 图表的标题</h3>
<p>   图表标题包括：主标题 - title ()、副标题 - subtitle ()、注释 - note ()、说明 - caption ()。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catter mpg weight, title (<span class="string">"主标题"</span>) subtitle (<span class="string">"副标题"</span>) <span class="keyword">note</span>(<span class="string">"注释内容"</span>) caption (<span class="string">"进一步的说明"</span>) <span class="comment">//box：四周加边框，box 后面添加 bexpand 时边框向两边延展 </span></span><br></pre></td></tr></table></figure>
<p>   标题的位置：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 重新定位：position () 的取值 </span></span><br><span class="line"><span class="comment">*        +---------------------------------------+</span></span><br><span class="line"><span class="comment">*        |        11         12        1         |</span></span><br><span class="line"><span class="comment">*        |                                       |</span></span><br><span class="line"><span class="comment">*        |       +-----------------------+       |</span></span><br><span class="line"><span class="comment">*        |10     |10 or 11   12   1 or 2 |     2 |</span></span><br><span class="line"><span class="comment">*        |       |                       |       |</span></span><br><span class="line"><span class="comment">*        |       |        绘 图 区       |       |</span></span><br><span class="line"><span class="comment">*        | 9     | 9       ring=0      3 |     3 |</span></span><br><span class="line"><span class="comment">*        |       |                       |       |</span></span><br><span class="line"><span class="comment">*        |       |                       |       |</span></span><br><span class="line"><span class="comment">*        | 8     | 7 or 8     6   4 or 5 |     4 |</span></span><br><span class="line"><span class="comment">*        |       +-----------------------+       |</span></span><br><span class="line"><span class="comment">*        |                                       |</span></span><br><span class="line"><span class="comment">*        |         7         6         5         |</span></span><br><span class="line"><span class="comment">*        +---------------------------------------+</span></span><br></pre></td></tr></table></figure>
<p>  ring () 的值越大，距离绘图区越远。</p>
<h3 id="2-2-3-tu-biao-de-qu-yu">2.2.3 图表的区域</h3>
<p>  Stata 的图表区域大致分为绘制图形的区域和外部绘制坐标轴标题的区域，以及分割两个区域之间的分割区和外部的边框区域。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 控制内区和外区的边距 </span></span><br><span class="line"><span class="keyword">twoway</span> function y=x, plotregion (margin (0))   <span class="comment">// 控制分割两个区域之间的分割区的宽度 </span></span><br><span class="line"><span class="keyword">twoway</span> function y=x, graphregion (margin (0))  <span class="comment">// 控制外部边框的大小  </span></span><br><span class="line"><span class="comment">* 控制图形的纵横比 </span></span><br><span class="line"><span class="keyword">twoway</span> function y=x, ysize (5) xsize (5)</span><br><span class="line"><span class="comment">* 绘图区的显示模式 </span></span><br><span class="line"><span class="keyword">twoway</span> function y=x, plotregion (style (none)) <span class="comment">//help areastyle 查看更多的显示模式 </span></span><br><span class="line"><span class="comment">* 背景颜色 </span></span><br><span class="line"><span class="keyword">sysuse</span> auto, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, graphregion (fcolor (green*0.8)) <span class="comment">///</span></span><br><span class="line">                    graphregion (ifcolor (yellow))   <span class="comment">///</span></span><br><span class="line">                    plotregion (fcolor (black*0.3))  <span class="comment">///  </span></span><br><span class="line">                    plotregion (ifcolor (white))     <span class="comment">///</span></span><br><span class="line">                    title (<span class="string">"Stata 图形分成四个区域"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="2-2-4-tu-li-de-she-zhi">2.2.4 图例的设置</h3>
<p>   在 Stata 中，图例的名称根据变量的标签自动确定，因此如果想设定中文图例，可以直接更改变量的标签。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> high date,legend (<span class="keyword">label</span> (1 <span class="string">"最高价"</span>))) (<span class="keyword">line</span> low date, legend (<span class="keyword">label</span> (2 <span class="string">"最低价"</span>))) <span class="comment">// 每个图单独加图例 </span></span><br><span class="line"><span class="keyword">twoway</span> <span class="keyword">line</span> high date || <span class="keyword">line</span> low date, legend (<span class="keyword">label</span>(1 <span class="string">"最高价"</span>) <span class="keyword">label</span>(2 <span class="string">"最低价"</span>))            <span class="comment">// 整体加图例 </span></span><br><span class="line"><span class="keyword">twoway</span> <span class="keyword">line</span> high date || <span class="keyword">line</span> low date, legend (position (12) ring (0))                          <span class="comment">// 更改图例的位置 </span></span><br><span class="line"><span class="keyword">line</span>  le le_w le_b  year, legend (rows (#))                                                     <span class="comment">// 图例重排：# 行 </span></span><br><span class="line"><span class="keyword">line</span>  le le_w le_b  year, legend (cols (1) size (small))                                         <span class="comment">// 图例重排：# 列 </span></span><br><span class="line"><span class="keyword">twoway</span> connect <span class="keyword">open</span> <span class="keyword">close</span> low  date <span class="keyword">in</span> 1/10, lpattern (solid dash longdash)                    <span class="comment">// 控制线型：lpattern</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>实线</th>
<th>solid line</th>
</tr>
</thead>
<tbody>
<tr>
<td>_</td>
<td>(underscore) a long dash</td>
</tr>
<tr>
<td>-</td>
<td>(hyphen) a medium dash</td>
</tr>
<tr>
<td>.</td>
<td>short dash (almost a dot)</td>
</tr>
<tr>
<td>#</td>
<td>small amount of blank space</td>
</tr>
</tbody>
</table>
<h3 id="2-2-5-fu-jia-xian">2.2.5 附加线</h3>
<p>   附加线的选项结构如下：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">twoway</span> ..., yline (数字，子选项)  <span class="comment">// 数字：控制附加线的位置 </span></span><br><span class="line"><span class="keyword">twoway</span> ..., xline (数字，子选项)  <span class="comment">// 子选项：控制附加线的类型、颜色、宽度等 </span></span><br></pre></td></tr></table></figure>
<p>   附加线的风格：style ()。defult：决定于显示模式 (set scheme)；extended：延伸到绘图外区；unextended：不延伸到绘图外区。</p>
<p>   附加线的线宽：lwidth，使用 help linewidthstyle 查看详细的线宽选项。</p>
<p>   附加线的颜色：lcolor，使用 graph query colorstyle 查看所有的可使用颜色。</p>
<p>   附加线的线型：lpattern，使用 palette linepalette 命令查看图示。</p>
<h3 id="2-2-6-wen-zi-yu-wen-ben-kuang">2.2.6 文字与文本框</h3>
<p>   文本框是文字的更一般化定义，文字是单行且无边框，文本框则是单行或多行，并且可加边框。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, tstyle (subheading)) <span class="comment">//graph query textboxstyle</span></span><br></pre></td></tr></table></figure>
<p>   文本框的属性：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box) <span class="comment">// 显示文本框 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box width (60) height (15)) <span class="comment">// 文本框的相对大小 </span></span><br><span class="line"><span class="comment">* 文本框的背景和边框的颜色 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box fcolor (blue*0.2))        <span class="comment">// 仅背景 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box bcolor (yellow*0.4))      <span class="comment">// 背景和边框 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box fc (blue*0.2) lc (red))    <span class="comment">//lc - 边框；fc - 背景。</span></span><br><span class="line"><span class="comment">* 文本框中边框的粗细、线型同附加线一样 </span></span><br><span class="line"><span class="comment">* 文字与边框的相对位置 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box width (60) height (15) alignment (middle))       <span class="comment">// 纵向定位 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, title (<span class="string">"SP500 开盘价"</span>, box width (60) height (15) justification (right))    <span class="comment">// 横向定位 </span></span><br></pre></td></tr></table></figure>
<p>   文字的属性：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 文字的位置 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, xtitle (<span class="string">"交易日期"</span>, place (right)) ytitle (<span class="string">"开盘价格"</span>, place (top)) <span class="comment">//help compassdirstyle</span></span><br><span class="line"><span class="comment">* 文字的角度 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, xlabel (, angle (30)) ylabel (,angle (0))  <span class="comment">//help anglestyle</span></span><br><span class="line"><span class="comment">* 文字大小 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, text (1324.83 15117 <span class="string">"一个波峰"</span>,size (huge)) <span class="comment">// 绝对大小 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, text (1324.83 15117 <span class="string">"一个波峰"</span>,size (*1.6)) <span class="comment">// 相对大小 </span></span><br><span class="line"><span class="comment">* 文字颜色 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, text (1324.83 15117 <span class="string">"一个波峰"</span>,color (blue)) <span class="comment">// 颜色后跟：* 数字，调节色度 </span></span><br><span class="line"><span class="comment">* 文字行距 </span></span><br><span class="line"><span class="keyword">line</span> <span class="keyword">open</span> date, <span class="keyword">note</span>(<span class="string">"SP500 指数的时序图"</span><span class="string">"(在此期间，股市两次大跌！)"</span>, color (blue) linegap (2.5))</span><br></pre></td></tr></table></figure>
<h3 id="2-2-7-tu-biao-lei">2.2.7 图表类</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">scatter</span> lexp gnppc <span class="keyword">if</span> region==2, mlabel (country2)   <span class="comment">//  mlabel (varname)</span></span><br><span class="line"><span class="keyword">scatter</span> lexp gnppc <span class="keyword">if</span> region==2, mlabel (country2) mlabp (3)  <span class="comment">//mlabp ()- 图标位置 </span></span><br><span class="line"><span class="comment">*  11  12  1</span></span><br><span class="line"><span class="comment">* 10         2</span></span><br><span class="line"><span class="comment">*  9    0    3</span></span><br><span class="line"><span class="comment">*  8         4</span></span><br><span class="line"><span class="comment">*    7  6  5</span></span><br><span class="line"><span class="keyword">scatter</span> lexp gnppc <span class="keyword">if</span> region==2, mlabel (country2) mlabvp (pos) mlabsize (*0.7)   <span class="comment">//mlabsize ()- 图标大小 </span></span><br><span class="line"><span class="keyword">scatter</span> lexp gnppc <span class="keyword">if</span> region==2, mlabel (country2) mlabvp (pos) mlabangle (15)    <span class="comment">//mlabanle ()- 图标角度 </span></span><br><span class="line"><span class="keyword">scatter</span> lexp gnppc <span class="keyword">if</span> region==2, mlabel (country2) mlabvp (pos) mlabcolor (green) <span class="comment">//mlabcolor ()- 图标颜色 </span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-8-qi-ta-xuan-xiang">2.2.8 其他选项</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* 分组绘图 </span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight, <span class="keyword">by</span>(foreign, <span class="keyword">total</span> cols (1) style (compact)) <span class="comment">//cols (#) 代表 #列，rows (#) 代表 #行，二者不能并存，style () 定义风格。</span></span><br><span class="line"><span class="keyword">twoway</span> <span class="keyword">line</span> high low date, yvarlabel (<span class="string">"最高价"</span> <span class="string">"最低价"</span>) xvarlabel (<span class="string">"交易日期"</span>) <span class="comment">// 重新设置变量标签：yvarlabel ()&amp;xvarlabel ()</span></span><br><span class="line"><span class="keyword">twoway</span> <span class="keyword">line</span> high date, xvarformat (% tdY-<span class="keyword">n</span>-<span class="keyword">d</span>) yvarformat (%6.2f) <span class="comment">// 重新设置变量显示格式:xvarformat ()&amp;yvarformat ()</span></span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> change date <span class="keyword">if</span> change&gt;0, <span class="keyword">recast</span>(spike)) (<span class="keyword">line</span> change date <span class="keyword">if</span> change&lt;0, <span class="keyword">recast</span>(area)) <span class="comment">// 重设图形种类：recast ()</span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-yuan-su-de-dai-hao">2.3 元素的代号</h2>
<h3 id="2-3-1-yan-se-dai-hao">2.3.1 颜色代号</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">full_palette  <span class="comment">// 66 种颜色，附加 RGB 代码 </span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-xian-de-dai-hao">2.3.2 线的代号</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">palette</span> linepalette                  <span class="comment">// 图示线型 </span></span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">query</span> linewidthstyle           <span class="comment">// 列出所有的线宽代号 </span></span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">query</span> connectstyle             <span class="comment">// 列出所有的连接方式代号 </span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-3-biao-ji-fu-hao-de-dai-hao">2.3.3 标记符号的代号</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">* mlcolor ()：边界颜色； mfcolor (): 填充颜色 </span></span><br><span class="line">showmarkers, over (msymbol)   <span class="comment">// 图示所有的标记符号 </span></span><br><span class="line">showmarkers, over (msize)     <span class="comment">// 图示尺寸 </span></span><br><span class="line">showmarkers, over (mcolor)    <span class="comment">// 图示边界颜色 </span></span><br><span class="line">showmarkers, over (mfcolor)   <span class="comment">// 图示填充颜色 </span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-4-wen-zi-xiang-guan-de-dai-hao">2.3.4 文字相关的代号</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">help</span> textsizestyle           <span class="comment">// 文字大小 </span></span><br><span class="line"><span class="keyword">help</span> anglestyle              <span class="comment">// 文字角度 </span></span><br><span class="line"><span class="keyword">help</span> justificationstyle      <span class="comment">// 左右对齐方式 </span></span><br><span class="line"><span class="keyword">help</span> alignmentstyle          <span class="comment">// 上下对齐方式 </span></span><br><span class="line"><span class="keyword">help</span> marginstyle             <span class="comment">// 边距大小 </span></span><br></pre></td></tr></table></figure>
<h1 id="3-chang-yong-tu-xing-de-shi-li">3. 常用图形的示例</h1>
<h2 id="3-1-san-dian-tu">3.1 散点图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">help</span> <span class="keyword">twoway</span> <span class="keyword">scatter</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">sysuse</span> uslifeexp2, <span class="keyword">clear</span></span><br><span class="line">#delimit ;</span><br><span class="line">  <span class="keyword">scatter</span> le year,</span><br><span class="line">          title (<span class="string">"图 1: 散点图示例"</span>)</span><br><span class="line">          subtitle (<span class="string">"预期寿命，美国"</span>)</span><br><span class="line">          yvarlabel (预期寿命)</span><br><span class="line">          xvarlabel (年份)</span><br><span class="line">          <span class="keyword">note</span>(<span class="string">"1"</span>)</span><br><span class="line">          caption ("数据来源：美国国家重要统计资料报告，</span><br><span class="line">                   第 5 卷 - 第 6 期")</span><br><span class="line">          scheme (economist);</span><br><span class="line">#delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-2-zhe-xian-tu">3.2 折线图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> uslifeexp, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">gen</span> diff = le_wmale - le_bmale</span><br><span class="line"><span class="keyword">label</span> <span class="keyword">var</span> diff <span class="string">"寿命差异"</span></span><br><span class="line">#delimit ;  </span><br><span class="line"> <span class="keyword">twoway</span> (<span class="keyword">line</span> le_wmale year, yaxis (1 2) xaxis (1 2))</span><br><span class="line">        (<span class="keyword">line</span> le_bmale year)</span><br><span class="line">        (<span class="keyword">line</span> diff  year)</span><br><span class="line">        ,</span><br><span class="line">        ylabel (0 20 (10) 80,     gmax angle (0))</span><br><span class="line">        ylabel (0 (5) 20, axis (2) gmin angle (0))</span><br><span class="line">        xlabel (1918, axis (2)) </span><br><span class="line">        title (<span class="string">"图 2：白人和黑人预期寿命"</span>)</span><br><span class="line">        subtitle (<span class="string">"美国，1900-1999"</span>)</span><br><span class="line">        ytitle (<span class="string">"预期寿命 (年)"</span>)</span><br><span class="line">        xtitle (<span class="string">"年份"</span>)</span><br><span class="line">        ytitle (<span class="string">""</span>, axis (2))</span><br><span class="line">        xtitle (<span class="string">""</span>, axis (2))</span><br><span class="line">        <span class="keyword">note</span>(<span class="string">"数据来源：美国国家重要统计资料报告，第 5 卷 - 第 6 期"</span></span><br><span class="line">             <span class="string">"(1918 巨降：源于 1918 年全国性流行感冒)"</span>,linegap (1.2))</span><br><span class="line">        legend (<span class="keyword">label</span>(1 <span class="string">"白人男性"</span>) <span class="keyword">label</span>(2 <span class="string">"黑人男性"</span>) </span><br><span class="line">               rows (1) size (*0.7));</span><br><span class="line">#delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-3-qu-yu-tu">3.3 区域图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> gnp96, <span class="keyword">clear</span></span><br><span class="line">#delimit ;</span><br><span class="line"> <span class="keyword">twoway</span> area <span class="keyword">d</span>.gnp96 date, </span><br><span class="line">             xlabel (36 (8) 164, angle (45))</span><br><span class="line">             ylabel (-100 (50) 200, angle (0))</span><br><span class="line">             ytitle (<span class="string">"Billions of 1996 Dollars"</span>)</span><br><span class="line">             xtitle (<span class="string">""</span>)</span><br><span class="line">             subtitle (<span class="string">"Change in U.S. GNP"</span>, position (11))</span><br><span class="line">             <span class="keyword">note</span>("Source: <span class="keyword">U</span>.S. Department of Commerce,</span><br><span class="line">                   Bureau of Economic Analysis") ;</span><br><span class="line">#delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-4-ding-xing-tu">3.4 钉形图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*-e.g 1: 简单钉形图 </span></span><br><span class="line">  <span class="keyword">sysuse</span> sp500, <span class="keyword">clear</span></span><br><span class="line">    <span class="keyword">replace</span> volume = volume/1000</span><br><span class="line">    #delimit ;</span><br><span class="line">        <span class="keyword">twoway</span> (rspike hi low date)</span><br><span class="line">               (<span class="keyword">line</span>   <span class="keyword">close</span>  date)</span><br><span class="line">               (bar    volume date, barw (.25) yaxis (2))</span><br><span class="line">                <span class="keyword">in</span> 1/57</span><br><span class="line">            , </span><br><span class="line">        yscale (axis (1) <span class="built_in">r</span>(900 1400))</span><br><span class="line">            yscale (axis (2) <span class="built_in">r</span>(  9   45))</span><br><span class="line">            ylabel (, axis (2) grid)</span><br><span class="line">            ytitle (<span class="string">"股价 -- 最高，最低，收盘"</span>,place (top))</span><br><span class="line">            ytitle (<span class="string">"交易量 (百万股)"</span>, axis (2) bexpand just (left))</span><br><span class="line">            xtitle (<span class="string">""</span>)</span><br><span class="line">            legend (off)</span><br><span class="line">            subtitle (<span class="string">"S&amp;P 500"</span>, margin (b+2.5))</span><br><span class="line">            <span class="keyword">note</span>(<span class="string">" 数据来源：雅虎财经！"</span>);</span><br><span class="line">    #delimit cr</span><br><span class="line"><span class="comment">*-e.g 2：区域钉形图 </span></span><br><span class="line"><span class="keyword">sysuse</span> sp500, <span class="keyword">clear</span>    </span><br><span class="line">  <span class="keyword">twoway</span> (rarea high low date)           <span class="comment">///</span></span><br><span class="line">         (spike volume date, yaxis (2)),  <span class="comment">///</span></span><br><span class="line">           legend (span)                    <span class="comment">///    </span></span><br><span class="line">           yscale (<span class="keyword">range</span>(500 1400) axis (1)) <span class="comment">///  //new!</span></span><br><span class="line">       yscale (<span class="keyword">range</span>(0 5) axis (2))      <span class="comment">///  //new!</span></span><br><span class="line">       ylabel (,angle (0))               <span class="comment">///// new!</span></span><br><span class="line">         ylabel (,angle (0) axis (2))</span><br></pre></td></tr></table></figure>
<h2 id="3-5-zhi-fang-tu">3.5 直方图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> sp500, <span class="keyword">clear</span></span><br><span class="line"> #delimit ;</span><br><span class="line"> <span class="keyword">histogram</span> volume, freq normal </span><br><span class="line">           addlabels addlabopts (mlabcolor (blue))</span><br><span class="line">           xaxis (1 2)</span><br><span class="line">           ylabel (0 (10) 65, grid)</span><br><span class="line">           xlabel ( 12321 <span class="string">"mean"</span></span><br><span class="line">                    9735 <span class="string">"-1 s.d."</span></span><br><span class="line">                   14907 <span class="string">"+1 s.d."</span></span><br><span class="line">                    7149 <span class="string">"-2 s.d."</span></span><br><span class="line">                   17493 <span class="string">"+2 s.d."</span></span><br><span class="line">                   20078 <span class="string">"+3 s.d."</span></span><br><span class="line">                   22664 <span class="string">"+4 s.d."</span></span><br><span class="line">                  ,axis (2) grid gmax</span><br><span class="line">                 )</span><br><span class="line">           subtitle (<span class="string">"图 4：S&amp;P 500 交易量 (2001 年 1 月 - 12 月)"</span>)</span><br><span class="line">           ytitle (频数)</span><br><span class="line">           xtitle (<span class="string">"交易量 (千笔)"</span>) xscale (titlegap (2))</span><br><span class="line">           xtitle (<span class="string">""</span>, axis (2))</span><br><span class="line">           <span class="keyword">note</span>(<span class="string">" 数据来源：雅虎！财经数据 "</span>);</span><br><span class="line"> #delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-6-mi-du-han-shu-tu">3.6 密度函数图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> sp500, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">kdensity</span> <span class="keyword">open</span>) (<span class="keyword">kdensity</span> low)  <span class="comment">// 把多个变量的核密度函数图绘制在一张图上 </span></span><br><span class="line"><span class="comment">*- 比较不同子样本的密度函数 </span></span><br><span class="line"><span class="keyword">sysuse</span> auto, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">kdensity</span> weight              , nograph <span class="keyword">gen</span>(p_x  d_x)</span><br><span class="line"><span class="keyword">kdensity</span> weight <span class="keyword">if</span> foreign==0, nograph <span class="keyword">gen</span>(p_x0 d_x0)</span><br><span class="line"><span class="keyword">kdensity</span> weight <span class="keyword">if</span> foreign==1, nograph <span class="keyword">gen</span>(p_x1 d_x1) </span><br><span class="line"><span class="keyword">label</span> <span class="keyword">var</span> d_x  <span class="string">"all cars"</span></span><br><span class="line"><span class="keyword">label</span> <span class="keyword">var</span> d_x0 <span class="string">"Domestic cars"</span></span><br><span class="line"><span class="keyword">label</span> <span class="keyword">var</span> d_x1 <span class="string">"Foreign cars"</span></span><br><span class="line"><span class="keyword">twoway</span> (<span class="keyword">line</span> d_x p_x) (<span class="keyword">line</span> d_x0 p_x0) (<span class="keyword">line</span> d_x1 p_x1)</span><br><span class="line">- 附加置信区间    -akdensity-</span><br><span class="line"><span class="keyword">sysuse</span> auto, <span class="keyword">clear</span></span><br><span class="line">akdensity length, stdbands (2)</span><br><span class="line"><span class="comment">*- 双变量联合密度函数图  -kdens2-</span></span><br><span class="line"><span class="keyword">use</span> grunfeld, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">gen</span> linv = <span class="built_in">log</span>(invest)</span><br><span class="line"><span class="keyword">gen</span> lmkt = <span class="built_in">log</span>(mvalue)</span><br><span class="line">kdens2 linv lmkt</span><br><span class="line">kdens2 linv lmkt, <span class="keyword">n</span>(100)         <span class="comment">//defaults Min (_N,50)</span></span><br><span class="line">kdens2 linv lmkt, xw (.5) <span class="built_in">yw</span>(.5)  <span class="comment">//defaults `optimal'</span></span><br></pre></td></tr></table></figure>
<h2 id="3-7-lei-ji-fen-bu-han-shu-tu">3.7 累积分布函数图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> auto, <span class="keyword">clear</span></span><br><span class="line"><span class="comment">* 外部命令：distplot</span></span><br><span class="line"><span class="comment">* 支持的图形种类：area bar connected dot dropline line scatter spike</span></span><br><span class="line"><span class="keyword">foreach</span> t <span class="keyword">in</span> area bar connected dot dropline <span class="keyword">line</span> <span class="keyword">scatter</span> spike &#123;</span><br><span class="line">  distplot mpg, <span class="keyword">by</span>(foreign) <span class="keyword">recast</span>(<span class="symbol">`t'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">* 外部命令：cdfplot</span></span><br><span class="line">cdfplot length, <span class="keyword">by</span>(foreign) norm saving (mygraph, <span class="keyword">replace</span>)</span><br></pre></td></tr></table></figure>
<h2 id="3-8-xian-xing-fei-xian-xing-ni-he-tu">3.8 线性 / 非线性拟合图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> auto, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">scatter</span> mpg weight || <span class="keyword">lfit</span> mpg weight, <span class="keyword">by</span>(foreign, <span class="keyword">total</span> row (1))</span><br><span class="line"><span class="keyword">twoway</span> (lfitci mpg wei, stdf) (<span class="keyword">scatter</span> mpg wei)  <span class="comment">// 线性拟合：注意前后顺序 </span></span><br><span class="line"><span class="keyword">twoway</span> (qfitci mpg wei, stdf) (<span class="keyword">scatter</span> mpg wei)  <span class="comment">// 非线性拟合 </span></span><br><span class="line"><span class="keyword">twoway</span> (qfitci mpg wei, stdf level (99) color (yellow)) <span class="comment">///</span></span><br><span class="line">       (qfitci mpg wei, stdf level (90))               <span class="comment">///</span></span><br><span class="line">       (<span class="keyword">scatter</span> mpg wei)                              <span class="comment">//level: 置信水准 </span></span><br></pre></td></tr></table></figure>
<h2 id="3-9-ju-zhen-tu-xian-shi-bian-liang-jian-de-xiang-guan-xing">3.9 矩阵图：显示变量间的相关性</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">graph</span> <span class="keyword">matrix</span> mpg weight length, <span class="built_in">diag</span>(<span class="string">"mpg (汽车里数)"</span> . <span class="string">"length (汽车长度)"</span>)</span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">matrix</span> mpg weight length, scale (0.8)     <span class="comment">// 整体缩放 </span></span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">matrix</span> heatdd-tempjuly, msymbol (point)   <span class="comment">// 指定图标 </span></span><br><span class="line"><span class="keyword">graph</span> <span class="keyword">matrix</span> heatdd-tempjuly, ms (p) half       <span class="comment">// 半边显示 </span></span><br></pre></td></tr></table></figure>
<h2 id="3-10-zhu-zhuang-tu">3.10 柱状图</h2>
<h3 id="3-10-1-yi-wei-zhu-zhuang-tu">3.10.1 一维柱状图</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> nlsw88, <span class="keyword">clear</span></span><br><span class="line">#delimit ;</span><br><span class="line"> <span class="keyword">graph</span> bar (<span class="keyword">mean</span>) wage, over (smsa) over (married) over (collgrad)</span><br><span class="line">           title (<span class="string">"Average Hourly Wage, 1988, Women Aged 34-46"</span>)</span><br><span class="line">           subtitle ("<span class="keyword">by</span> College Graduation, Marital Status,</span><br><span class="line">                      and SMSA residence")</span><br><span class="line">            <span class="keyword">note</span>("Source:  1988 data from NLS, <span class="keyword">U</span>.S. Dept. of Labor,</span><br><span class="line">                  Bureau of Labor Statistics");</span><br><span class="line">#delimit cr</span><br><span class="line"><span class="comment">* 柱体的样式: bstyle</span></span><br><span class="line"><span class="keyword">graph</span> bar (<span class="keyword">mean</span>) wage hours, over (race) over (married) <span class="comment">///</span></span><br><span class="line">                 scheme (s1mono)      <span class="comment">///</span></span><br><span class="line">                 bar (1, bstyle (p1))  <span class="comment">///</span></span><br><span class="line">                 bar (2, bstyle (p6))</span><br><span class="line"><span class="comment">* 柱体的标签： blabel</span></span><br><span class="line"><span class="keyword">graph</span> bar (<span class="keyword">mean</span>) wage, over (race) over (married) blabel (bar, position (outside) <span class="keyword">format</span>(%3.1f) color (green))  </span><br><span class="line"><span class="comment">* 累加柱体 </span></span><br><span class="line"><span class="keyword">graph</span> hbar (<span class="keyword">mean</span>) public private, over (country) <span class="keyword">stack</span>                </span><br><span class="line"><span class="comment">* 柱体间隔：bargap</span></span><br><span class="line"><span class="keyword">sysuse</span> nlsw88, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">graph</span> bar (<span class="keyword">mean</span>) hours wage, over (race) over (married) bargap (-30)</span><br><span class="line"><span class="keyword">graph</span> hbar wage, over (ind, <span class="keyword">sort</span>(1)) over (collgrad) ysize (4) xsize (8)   <span class="comment">// 图形的比例 </span></span><br></pre></td></tr></table></figure>
<h3 id="3-10-2-er-wei-zhu-zhuang-tu">3.10.2 二维柱状图</h3>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*- 一个较复杂的例子 </span></span><br><span class="line"><span class="keyword">sysuse</span> pop2000, <span class="keyword">clear</span></span><br><span class="line"><span class="keyword">replace</span> maletotal = -maletotal/1e+6</span><br><span class="line"><span class="keyword">replace</span> femtotal = femtotal/1e+6</span><br><span class="line"><span class="keyword">gen</span> zero = 0</span><br><span class="line">#delimit ;</span><br><span class="line"> <span class="keyword">twoway</span></span><br><span class="line">     (bar maletotal agegrp, horizontal xvarlab (Males))</span><br><span class="line">     (bar  femtotal agegrp, horizontal xvarlab (Females))</span><br><span class="line">     (<span class="keyword">scatter</span>  agegrp zero, mlabel (agegrp) mlabcolor (black) msymbol (i))</span><br><span class="line">    , xtitle (<span class="string">"Population in millions"</span>) ytitle (<span class="string">""</span>)</span><br><span class="line">      plotregion (style (none))     </span><br><span class="line">      ysca (noline) ylabel (none)    </span><br><span class="line">      xsca (noline titlegap (-3.5))  </span><br><span class="line">      xlabel (-12 <span class="string">"12"</span> -10 <span class="string">"10"</span> -8 <span class="string">"8"</span> -6 <span class="string">"6"</span> -4 <span class="string">"4"</span> 4 (2) 12, </span><br><span class="line">         tlength (0) grid gmin gmax)</span><br><span class="line">      legend (<span class="keyword">label</span>(1 Males) <span class="keyword">label</span>(2 Females)) </span><br><span class="line">  legend (<span class="keyword">order</span>(1 2))</span><br><span class="line">      title (<span class="string">"US Male and Female Population by Age, 2000"</span>)</span><br><span class="line">      <span class="keyword">note</span>(<span class="string">"Source: U.S. Census Bureau, Census 2000"</span>)</span><br><span class="line">  ;</span><br><span class="line"> #delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-11-dian-tu">3.11 点图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sysuse</span> nlsw88, <span class="keyword">clear</span></span><br><span class="line">#delimit ;</span><br><span class="line"><span class="keyword">graph</span> dot wage, over (occ, <span class="keyword">sort</span>(1))</span><br><span class="line">      <span class="keyword">by</span>(collgrad,</span><br><span class="line">         title (<span class="string">"Average hourly wage, 1988, women aged 34-46"</span>, span)</span><br><span class="line">         subtitle (<span class="string">""</span>)</span><br><span class="line">         <span class="keyword">note</span>("Source:  1988 data from NLS, <span class="keyword">U</span>.S. Dept. of Labor, </span><br><span class="line">Bureau of Labor Statistics", span)</span><br><span class="line">        );</span><br><span class="line">#delimit cr</span><br></pre></td></tr></table></figure>
<h2 id="3-12-han-shu-tu">3.12 函数图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">twoway</span> function [[y]=] <span class="built_in">f</span>(x) [<span class="keyword">if</span>] [<span class="keyword">in</span>] [, options]</span><br></pre></td></tr></table></figure>
<h2 id="3-13-san-wei-tu">3.13 三维图</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">clear</span></span><br><span class="line"><span class="keyword">set</span> obs 900</span><br><span class="line"><span class="keyword">gen</span> x = int ((_n - <span class="built_in">mod</span>(_n-1,30) -1 ) /30 )</span><br><span class="line"><span class="keyword">gen</span> y = <span class="built_in">mod</span>(_n-1,30)</span><br><span class="line"><span class="keyword">gen</span> z = <span class="built_in">normalden</span>(x,10,3)*<span class="built_in">normalden</span>(y,15,5)</span><br><span class="line">surface x y z</span><br></pre></td></tr></table></figure>
<h2 id="3-14-di-tu">3.14 地图</h2>
<p>   中国地图：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spmap x using <span class="string">"china_map.dta"</span>, id (id)                  <span class="comment">/// </span></span><br><span class="line">  <span class="keyword">label</span>(<span class="keyword">label</span>(name)                                    <span class="comment">///</span></span><br><span class="line">    xcoord (x_coord) ycoord (y_coord) size (*.9))         <span class="comment">///</span></span><br><span class="line">plotregion (icolor (stone)) graphregion (icolor (stone)) <span class="comment">///</span></span><br><span class="line">  clnumber (8) fc (Greens2) oc (white ..) osize (medthin ..)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
      
    </div>

    <div>
        
        <div>
    
        <div style="text-align:center;color: #666699;font-size:14px;">------ 本文已经结束，感谢您的阅读！------</div>
    
</div>
        
    </div> 
     
            <h3> 相关文章：</h3><ul class="related-posts"><li><a href="/2019/07/10/stata处理数据的技巧/">stata 处理数据的技巧</a></li><li><a href="/2019/09/09/ajax：动态加载/">ajax：动态加载</a></li><li><a href="/2019/09/08/scrapy学习（三）/">scrapy 学习（三）</a></li><li><a href="/2019/08/29/scrapy学习（二）/">scrapy 学习（二）</a></li><li><a href="/2019/08/28/scrapy学习（一）/">scrapy 学习（一）</a></li><li><a href="/2019/08/02/相对重要性分析：domin命令/">相对重要性分析：domin 命令</a></li></ul> 
    
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>最喜欢你一言不合就打赏的样子了~~~么么！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="https://blog-1258437747.cos.ap-chengdu.myqcloud.com/wechatpay.jpg" alt="周卫东 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="https://blog-1258437747.cos.ap-chengdu.myqcloud.com/alipay.jpg" alt="周卫东 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    周卫东
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://zhouweidong.ml/2019/07/27/用stata作图/" title="用 stata 作图">http://zhouweidong.ml/2019/07/27/用stata作图/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/基础/" rel="tag"><i class="fa fa-tag"></i> 基础</a>
          
            <a href="/tags/Stata/" rel="tag"><i class="fa fa-tag"></i> Stata</a>
          
            <a href="/tags/图形/" rel="tag"><i class="fa fa-tag"></i> 图形</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating">
            <div id="wpac-rating"></div>
          </div>
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07/27/Dir函数/" rel="next" title="Dir 函数">
                <i class="fa fa-chevron-left"></i> Dir 函数
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/31/使用VBA数组/" rel="prev" title="使用 VBA 数组">
                使用 VBA 数组 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNzYwOC8xNDEzOQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=0&id=2660247525&auto=1&height=32"></iframe>
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://blog-1258437747.cos.ap-chengdu.myqcloud.com/IMG_9432===_美艺达证件照.jpg" alt="周卫东">
            
              <p class="site-author-name" itemprop="name">周卫东</p>
              <p class="site-description motion-element" itemprop="description">行到水穷处，坐看云起时。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">58</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/weidongzhou1994" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:sirzhouchn@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/SirzhouchnZhou" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://www.zhihu.com/people/your-user-name" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://google.com/" title="google" target="_blank">google</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://wiki.com/" title="wiki" target="_blank">wiki</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-stata-zuo-tu-jian-jie"><span class="nav-text">1. stata 作图简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-stata-neng-zuo-shi-yao-tu"><span class="nav-text">1.1 stata 能做什么图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-bao-cun-tu"><span class="nav-text">1.2 保存图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-dao-chu-tu-xing"><span class="nav-text">1.3 导出图形</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-liu-lan-nei-cun-zhong-de-tu-pian"><span class="nav-text">1.4 浏览内存中的图片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-shi-yong-hui-tu-mo-ban"><span class="nav-text">1.5 使用绘图模板</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-er-wei-tu"><span class="nav-text">2. 二维图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-er-wei-tu-ming-ling-de-ji-ben-jie-gou"><span class="nav-text">2.1 二维图命令的基本结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-er-wei-tu-de-xuan-xiang-jin-yi-bu-diao-zheng-tu-xing"><span class="nav-text">2.2 二维图的选项：进一步调整图形</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-zuo-biao-zhou"><span class="nav-text">2.2.1 坐标轴</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-tu-biao-de-biao-ti"><span class="nav-text">2.2.2 图表的标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-3-tu-biao-de-qu-yu"><span class="nav-text">2.2.3 图表的区域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-4-tu-li-de-she-zhi"><span class="nav-text">2.2.4 图例的设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-5-fu-jia-xian"><span class="nav-text">2.2.5 附加线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-6-wen-zi-yu-wen-ben-kuang"><span class="nav-text">2.2.6 文字与文本框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-7-tu-biao-lei"><span class="nav-text">2.2.7 图表类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-8-qi-ta-xuan-xiang"><span class="nav-text">2.2.8 其他选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-yuan-su-de-dai-hao"><span class="nav-text">2.3 元素的代号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-yan-se-dai-hao"><span class="nav-text">2.3.1 颜色代号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-xian-de-dai-hao"><span class="nav-text">2.3.2 线的代号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-3-biao-ji-fu-hao-de-dai-hao"><span class="nav-text">2.3.3 标记符号的代号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-4-wen-zi-xiang-guan-de-dai-hao"><span class="nav-text">2.3.4 文字相关的代号</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-chang-yong-tu-xing-de-shi-li"><span class="nav-text">3. 常用图形的示例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-san-dian-tu"><span class="nav-text">3.1 散点图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-zhe-xian-tu"><span class="nav-text">3.2 折线图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-qu-yu-tu"><span class="nav-text">3.3 区域图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-ding-xing-tu"><span class="nav-text">3.4 钉形图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-zhi-fang-tu"><span class="nav-text">3.5 直方图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-mi-du-han-shu-tu"><span class="nav-text">3.6 密度函数图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-lei-ji-fen-bu-han-shu-tu"><span class="nav-text">3.7 累积分布函数图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-8-xian-xing-fei-xian-xing-ni-he-tu"><span class="nav-text">3.8 线性 / 非线性拟合图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-9-ju-zhen-tu-xian-shi-bian-liang-jian-de-xiang-guan-xing"><span class="nav-text">3.9 矩阵图：显示变量间的相关性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-10-zhu-zhuang-tu"><span class="nav-text">3.10 柱状图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-10-1-yi-wei-zhu-zhuang-tu"><span class="nav-text">3.10.1 一维柱状图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-10-2-er-wei-zhu-zhuang-tu"><span class="nav-text">3.10.2 二维柱状图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-11-dian-tu"><span class="nav-text">3.11 点图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-12-han-shu-tu"><span class="nav-text">3.12 函数图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-13-san-wei-tu"><span class="nav-text">3.13 三维图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-14-di-tu"><span class="nav-text">3.14 地图</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周卫东</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">75.8k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("V4gz8O6rLgpERkSPQNtWOes7-gzGzoHsz", "tjlRL7JN4yhCaHjFTE9aVhws");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/vendors/needsharebutton/needsharebutton.css">

  
  
  <script src="/vendors/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Pinterest,Facebook,GooglePlus,Reddit,Linkedin,Tumblr,Evernote";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 18587,
    el: 'wpac-rating',
    color: 'fc6423'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '//embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

 </body>
</html>

<!--崩溃欺骗-->
<script type="text/javascript" src="/js/src/crash_cheat.js"></script>

<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>